VERSION="1.0.6"
SRCDIR="bzip2-${VERSION}"
TARBALL="${SRCDIR}.tar.gz"
URL="http://www.bzip.org/1.0.6/"
SHA256SUM="a2848f34fcd5d6cf47def00461fcb528a0484d8edef8208d6d2e2909dc61d9cd"
DEPENDS="toolchain"

prepare() {
	return
}

build() {
	cp -r ${1}/* ${PKGBUILDDIR}

	make CC=${TARGET}-gcc AR=${TARGET}-ar RANLIB=${TARGET}-ranlib -j $NUMJOBS libbz2.a bzip2 bzip2recover
}

deploy() {
	local SOURCE="$1"
	local DEPLOY="$2"
	local DEVDEPLOY="$3"

	make PREFIX="$DEPLOY" install

	rm -r $DEPLOY/man

	strip_files ${DEPLOY}/bin/*

	rm ${DEPLOY}/bin/{bzegrep,bzfgrep,bzless,bzcmp}

	ln -s "/bin/bzgrep" "$DEPLOY/bin/bzegrep"
	ln -s "/bin/bzgrep" "$DEPLOY/bin/bzfgrep"
	ln -s "/bin/bzmore" "$DEPLOY/bin/bzless"
	ln -s "/bin/bzdiff" "$DEPLOY/bin/bzcmp"

	split_dev_deploy "$DEPLOY" "$DEVDEPLOY"
	rmdir "$DEPLOY/lib"
}
