VERSION="1.1.0h"
SRCDIR="openssl-${VERSION}"
TARBALL="${SRCDIR}.tar.gz"
URL="https://www.openssl.org/source"
SHA256SUM="5835626cde9e99656585fc7aaa2302a73a7e1340bf8c14fd635a62c66802a517"
DEPENDS="zlib"

prepare() {
	return
}

build() {
	$1/Configure --prefix=/ --cross-compile-prefix="${TARGET}-" \
		     --openssldir=/etc/ssl --libdir=/lib \
		     -DOPENSSL_NO_HEARTBEATS \
		     threads shared zlib-dynamic no-async $OPENSSL_TARGET

	make -j 1
}

deploy() {
	local SOURCE="$1"
	local DEPLOY="$2"
	local DEVDEPLOY="$3"

	make DESTDIR="$DEPLOY" install

	rm "$DEPLOY/bin/c_rehash"
	rm -r "$DEPLOY/etc/ssl/misc" "$DEPLOY/share"

	split_dev_deploy "$DEPLOY" "$DEVDEPLOY"
	strip_files ${DEPLOY}/bin/* ${DEPLOY}/lib/*.so*
}
