VERSION="1.1.0i"
SRCDIR="openssl-${VERSION}"
TARBALL="${SRCDIR}.tar.gz"
URL="https://www.openssl.org/source"
SHA256SUM="ebbfc844a8c8cc0ea5dc10b86c9ce97f401837f3fa08c17b2cdadc118253cf99"
DEPENDS="zlib"

prepare() {
	return
}

build() {
	$1/Configure --prefix=/ --cross-compile-prefix="${TARGET}-" \
		     --openssldir=/etc/ssl --libdir=/lib \
		     -DOPENSSL_NO_HEARTBEATS \
		     threads shared zlib-dynamic no-async $OPENSSL_TARGET

	make -j 1
}

deploy() {
	local SOURCE="$1"
	local DEPLOY="$2"

	make DESTDIR="$DEPLOY" install
	cp "$SCRIPTDIR/pkg/$PKGNAME/rootfs_files.txt" "$DEPLOY"
}

check_update() {
	local version=$(echo $VERSION | sed 's/\([[:lower:]]\)/.\1/g')

	curl --silent -L "$URL" | grep -o ">openssl-[0-9a-z.]*tar.gz<" | \
	    sed 's/>openssl-//g' | sed 's/.tar.gz<//g' | \
	    sed 's/\([[:lower:]]\)/.\1/g' | \
	    verson_find_greatest "$version"
}