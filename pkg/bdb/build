VERSION="6.2.32"
SRCDIR="db-${VERSION}"
TARBALL="${SRCDIR}.tar.gz"
URL="http://download.oracle.com/berkeley-db/"
SHA256SUM="a9c5e2b004a5777aa03510cfe5cd766a4a3b777713406b02809c17c8e0e7a8fb"
DEPENDS=""

prepare() {
	return
}

build() {
	local INPUT="$1"
	local OUTPUT="$2"

	$INPUT/dist/configure --prefix="" --host="$TARGET" \
			      --enable-compat185 --enable-dbm \
			      --disable-static --enable-cxx

	make -j $NUMJOBS
}

deploy() {
	local SOURCE="$1"
	local BUILD="$2"
	local DEPLOY="$3"
	local DEVDEPLOY="$4"

	make DESTDIR="$DEPLOY" install

	for library in ${DEPLOY}/lib/*.so; do
		${TARGET}-strip --strip-unneeded $library
	done

	for program in ${DEPLOY}/bin/db_*; do
		chmod 755 $program
		${TARGET}-strip --discard-all $program
	done

	rm -r "$DEPLOY/docs"

	mv "$DEPLOY/include" "$DEVDEPLOY"
	cp -r "$DEPLOY/lib" "$DEVDEPLOY"
	rm ${DEPLOY}/lib/*.la
}
