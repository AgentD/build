VERSION="R_2_2_6"
SRCDIR="libexpat-${VERSION}/expat"
TARBALL="${VERSION}.tar.gz"
URL="https://github.com/libexpat/libexpat/archive"
SHA256SUM="574499cba22a599393e28d99ecfa1e7fc85be7d6651d543045244d5b561cb7ff"
DEPENDS="libbsd-dev crt-dev"
SUBPKG="expat expat-dev"

prepare() {
	autoreconf --force --install --symlink
}

build() {
	run_configure "$1" --without-xmlwf --with-libbsd
	make -j $NUMJOBS
}

deploy() {
	make DESTDIR="$PKGDEPLOYDIR" install
	cp $SCRIPTDIR/pkg/$PKGNAME/*.{files,desc} "$PKGDEPLOYDIR"
}

check_update() {
	local version=$(echo "$VERSION" | sed 's/R_//g' | sed 's/_/./g')

	curl --silent -L "https://github.com/libexpat/libexpat/releases" | \
	    grep -o "expat-[0-9.]*tar.bz2" | \
	    sed 's/expat-//g' | sed 's/.tar.bz2//g' | \
	    verson_find_greatest "$version"
}
